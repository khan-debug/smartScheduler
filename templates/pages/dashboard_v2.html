{% extends "layouts/base_v2.html" %}

{% block title %}Dashboard - Smart Scheduler{% endblock %}

{% block content %}
<div style="padding: var(--space-8); max-width: 1400px; margin: 0 auto;">
    <!-- Welcome Header -->
    <div style="margin-bottom: var(--space-8);">
        <h1 style="margin-bottom: var(--space-2);">
            {% if session.get('role') == 'admin' %}
                Good day, Admin! ðŸ‘‹
            {% else %}
                Welcome back, {{ session.get('username', 'User') }}! ðŸ‘‹
            {% endif %}
        </h1>
        <p class="text-secondary">Here's what's happening with your schedule today</p>
    </div>

    {% if session.get('role') == 'admin' %}
    <!-- Admin Dashboard -->

    <!-- Stats Overview -->
    <div class="card-grid card-grid-lg-4" style="margin-bottom: var(--space-8);">
        <a href="{{ url_for('manage_users', from_dashboard=True) }}" style="text-decoration: none;">
            <div class="stat-card">
                <p class="stat-card-label">Total Faculty</p>
                <p class="stat-card-value">{{ teacher_count }}</p>
                <p class="stat-card-change stat-card-change-positive">
                    <i class="fas fa-users"></i>
                    <span>Active members</span>
                </p>
            </div>
        </a>

        <a href="{{ url_for('manage_courses', from_dashboard=True) }}" style="text-decoration: none;">
            <div class="stat-card stat-card-success">
                <p class="stat-card-label">Total Courses</p>
                <p class="stat-card-value">{{ course_count }}</p>
                <p class="stat-card-change">
                    <i class="fas fa-book"></i>
                    <span>Active courses</span>
                </p>
            </div>
        </a>

        <a href="{{ url_for('manage_rooms', from_dashboard=True) }}" style="text-decoration: none;">
            <div class="stat-card stat-card-info">
                <p class="stat-card-label">Total Rooms</p>
                <p class="stat-card-value">{{ room_count }}</p>
                <p class="stat-card-change">
                    <i class="fas fa-door-open"></i>
                    <span>Available spaces</span>
                </p>
            </div>
        </a>

        <div class="stat-card stat-card-warning">
            <p class="stat-card-label">Room Utilization</p>
            <p class="stat-card-value">--</p>
            <p class="stat-card-change">
                <i class="fas fa-chart-line"></i>
                <span>Coming soon</span>
            </p>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-6); margin-bottom: var(--space-8);">
        <!-- Quick Actions -->
        <div class="card card-elevated">
            <div class="card-header">
                <h3 class="card-title">Quick Actions</h3>
                <p class="card-subtitle">Frequently used features</p>
            </div>
            <div class="card-body">
                <div class="card-grid card-grid-sm-2">
                    <!-- Schedule Class -->
                    <a href="/manual_timetable_edit" class="card card-interactive">
                        <div class="card-body" style="text-align: center;">
                            <div style="font-size: var(--text-4xl); color: var(--primary-500); margin-bottom: var(--space-3);">
                                <i class="fas fa-calendar-plus"></i>
                            </div>
                            <h4 style="margin-bottom: var(--space-2);">Schedule Class</h4>
                            <p class="text-sm text-secondary">Manually assign classes to rooms</p>
                        </div>
                    </a>

                    <!-- View Timetable -->
                    <a href="/view_timetable" class="card card-interactive">
                        <div class="card-body" style="text-align: center;">
                            <div style="font-size: var(--text-4xl); color: var(--success-500); margin-bottom: var(--space-3);">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <h4 style="margin-bottom: var(--space-2);">View Timetable</h4>
                            <p class="text-sm text-secondary">Browse all scheduled classes</p>
                        </div>
                    </a>

                    <!-- Manage Courses -->
                    <a href="/manage_courses" class="card card-interactive">
                        <div class="card-body" style="text-align: center;">
                            <div style="font-size: var(--text-4xl); color: var(--info-500); margin-bottom: var(--space-3);">
                                <i class="fas fa-book"></i>
                            </div>
                            <h4 style="margin-bottom: var(--space-2);">Manage Courses</h4>
                            <p class="text-sm text-secondary">Add or edit course information</p>
                        </div>
                    </a>

                    <!-- Import Data -->
                    <a href="/import_data" class="card card-interactive">
                        <div class="card-body" style="text-align: center;">
                            <div style="font-size: var(--text-4xl); color: var(--warning-500); margin-bottom: var(--space-3);">
                                <i class="fas fa-file-import"></i>
                            </div>
                            <h4 style="margin-bottom: var(--space-2);">Import Data</h4>
                            <p class="text-sm text-secondary">Bulk import courses & faculty</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>

        <!-- System Overview -->
        <div class="card card-elevated">
            <div class="card-header">
                <h3 class="card-title">System Overview</h3>
            </div>
            <div class="card-body">
                <div class="card-list">
                    <div class="card-list-item" style="cursor: default; transform: none;">
                        <div class="card-list-item-icon" style="background-color: var(--primary-100);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="card-list-item-content">
                            <p class="card-list-item-title">Faculty Members</p>
                            <p class="card-list-item-description">{{ teacher_count }} registered</p>
                        </div>
                    </div>

                    <div class="card-list-item" style="cursor: default; transform: none;">
                        <div class="card-list-item-icon" style="background-color: var(--success-100); color: var(--success-600);">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="card-list-item-content">
                            <p class="card-list-item-title">Active Courses</p>
                            <p class="card-list-item-description">{{ course_count }} courses</p>
                        </div>
                    </div>

                    <div class="card-list-item" style="cursor: default; transform: none;">
                        <div class="card-list-item-icon" style="background-color: var(--info-100); color: var(--info-600);">
                            <i class="fas fa-door-open"></i>
                        </div>
                        <div class="card-list-item-content">
                            <p class="card-list-item-title">Available Rooms</p>
                            <p class="card-list-item-description">{{ room_count }} rooms</p>
                        </div>
                    </div>

                    <div class="card-list-item" style="cursor: default; transform: none;">
                        <div class="card-list-item-icon" style="background-color: var(--warning-100); color: var(--warning-600);">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="card-list-item-content">
                            <p class="card-list-item-title">Scheduled Classes</p>
                            <p class="card-list-item-description">Coming soon</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Getting Started Guide -->
    <div class="card card-elevated">
        <div class="card-header">
            <h3 class="card-title">Getting Started</h3>
        </div>
        <div class="card-body">
            <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                <div style="display: flex; gap: var(--space-3);">
                    <div style="flex-shrink: 0; width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary-500), var(--secondary-600)); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; color: white; font-weight: var(--weight-bold);">1</div>
                    <div>
                        <h5 style="margin-bottom: var(--space-1);">Add Faculty</h5>
                        <p class="text-sm text-secondary">Import or manually add faculty members to the system</p>
                    </div>
                </div>

                <div style="display: flex; gap: var(--space-3);">
                    <div style="flex-shrink: 0; width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary-500), var(--secondary-600)); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; color: white; font-weight: var(--weight-bold);">2</div>
                    <div>
                        <h5 style="margin-bottom: var(--space-1);">Create Courses</h5>
                        <p class="text-sm text-secondary">Set up courses with sections and assign faculty</p>
                    </div>
                </div>

                <div style="display: flex; gap: var(--space-3);">
                    <div style="flex-shrink: 0; width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary-500), var(--secondary-600)); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; color: white; font-weight: var(--weight-bold);">3</div>
                    <div>
                        <h5 style="margin-bottom: var(--space-1);">Setup Rooms</h5>
                        <p class="text-sm text-secondary">Configure available classrooms and labs</p>
                    </div>
                </div>

                <div style="display: flex; gap: var(--space-3);">
                    <div style="flex-shrink: 0; width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary-500), var(--secondary-600)); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; color: white; font-weight: var(--weight-bold);">4</div>
                    <div>
                        <h5 style="margin-bottom: var(--space-1);">Schedule Classes</h5>
                        <p class="text-sm text-secondary">Assign time slots and rooms to courses</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer">
            <button class="btn btn-secondary" onclick="window.location.href='/getting_started'">
                <i class="fas fa-rocket"></i>
                <span>Get Started</span>
            </button>
        </div>
    </div>

    {% else %}
    <!-- Teacher Dashboard -->

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-6); margin-bottom: var(--space-8);">
        <a href="/teacher" class="card card-interactive">
            <div class="card-body" style="text-align: center; padding: var(--space-8);">
                <div style="font-size: var(--text-5xl); color: var(--primary-500); margin-bottom: var(--space-4);">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <h3 style="margin-bottom: var(--space-2);">My Timetable</h3>
                <p class="text-secondary">View your teaching schedule</p>
            </div>
        </a>

        <a href="/teacher/about" class="card card-interactive">
            <div class="card-body" style="text-align: center; padding: var(--space-8);">
                <div style="font-size: var(--text-5xl); color: var(--success-500); margin-bottom: var(--space-4);">
                    <i class="fas fa-user"></i>
                </div>
                <h3 style="margin-bottom: var(--space-2);">My Profile</h3>
                <p class="text-secondary">View your profile and courses</p>
            </div>
        </a>
    </div>

    <div class="card card-elevated">
        <div class="card-header">
            <h3 class="card-title">Welcome to Smart Scheduler</h3>
        </div>
        <div class="card-body">
            <p style="margin-bottom: var(--space-4);">Access your teaching schedule and manage your profile from the links above.</p>
            <p class="text-sm text-secondary">If you have any questions or need assistance, please contact your administrator.</p>
        </div>
    </div>

    {% endif %}
</div>

<style>
    /* Responsive adjustments */
    @media (max-width: 1024px) {
        [style*="grid-template-columns: 2fr 1fr"] {
            grid-template-columns: 1fr !important;
        }

        [style*="grid-template-columns: 1fr 1fr"] {
            grid-template-columns: 1fr !important;
        }
    }

    @media (max-width: 640px) {
        .card-grid {
            grid-template-columns: 1fr !important;
        }
    }
</style>
{% endblock %}
