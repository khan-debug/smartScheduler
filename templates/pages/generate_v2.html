{% extends "layouts/base_v2.html" %}

{% block title %}Generate Schedule{% endblock %}

{% block content %}
<div style="padding: var(--space-8); max-width: 1400px; margin: 0 auto;">
    <!-- Page Header -->
    <div style="margin-bottom: var(--space-8);">
        <h1 style="margin-bottom: var(--space-2);">Generate Schedule</h1>
        <p class="text-secondary">Create and manage your class timetables</p>
    </div>

    <!-- Action Cards Grid -->
    <div style="display: grid; gap: var(--space-6); max-width: 1000px;">

        <!-- Autogenerate Card -->
        <div class="card card-elevated card-interactive" id="autogenerateTimetableBtn" style="cursor: pointer;">
            <div class="card-body" style="padding: var(--space-8);">
                <div style="display: flex; align-items: start; gap: var(--space-6);">
                    <!-- Icon -->
                    <div style="flex-shrink: 0;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary-500) 0%, var(--secondary-600) 100%); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-lg);">
                            <i class="fas fa-magic" style="font-size: var(--text-4xl); color: white;"></i>
                        </div>
                    </div>

                    <!-- Content -->
                    <div style="flex: 1;">
                        <h2 style="margin-bottom: var(--space-3); font-size: var(--text-2xl); color: var(--text-primary);">
                            Auto-Generate Timetable
                        </h2>
                        <p class="text-secondary" style="margin-bottom: var(--space-4); line-height: 1.6;">
                            Automatically create an optimized timetable based on your courses, faculty, and room availability. Our intelligent algorithm will handle all the scheduling constraints.
                        </p>
                        <div style="display: flex; gap: var(--space-3); flex-wrap: wrap;">
                            <span style="background-color: var(--primary-100); color: var(--primary-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                <i class="fas fa-robot"></i> AI-Powered
                            </span>
                            <span style="background-color: var(--success-100); color: var(--success-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                <i class="fas fa-clock"></i> Fast
                            </span>
                            <span style="background-color: var(--info-100); color: var(--info-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                <i class="fas fa-check-circle"></i> Optimized
                            </span>
                        </div>
                    </div>

                    <!-- Arrow -->
                    <div style="flex-shrink: 0; align-self: center;">
                        <i class="fas fa-chevron-right" style="font-size: var(--text-2xl); color: var(--text-tertiary);"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- View Timetable Card -->
        <div class="card card-elevated card-interactive" id="viewTimetableCard" style="cursor: pointer; position: relative;">
            <!-- Coming Soon Badge -->
            <div style="position: absolute; top: var(--space-4); right: var(--space-4); background: linear-gradient(135deg, var(--info-500) 0%, var(--info-600) 100%); color: white; padding: var(--space-2) var(--space-4); border-radius: var(--radius-full); font-size: var(--text-sm); font-weight: var(--weight-semibold); box-shadow: var(--shadow-md); z-index: 1;">
                <i class="fas fa-clock"></i> Coming Soon
            </div>

            <div class="card-body" style="padding: var(--space-8);">
                <div style="display: flex; align-items: start; gap: var(--space-6);">
                    <!-- Icon -->
                    <div style="flex-shrink: 0;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--success-500) 0%, var(--success-600) 100%); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-lg);">
                            <i class="fas fa-calendar-alt" style="font-size: var(--text-4xl); color: white;"></i>
                        </div>
                    </div>

                    <!-- Content -->
                    <div style="flex: 1;">
                        <h2 style="margin-bottom: var(--space-3); font-size: var(--text-2xl); color: var(--text-primary);">
                            View Created Timetable
                        </h2>
                        <p class="text-secondary" style="margin-bottom: var(--space-4); line-height: 1.6;">
                            Review and explore your generated timetables. View schedules by course, room, or faculty member with various filtering options.
                        </p>
                        <div style="display: flex; gap: var(--space-3); flex-wrap: wrap;">
                            <span style="background-color: var(--success-100); color: var(--success-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                <i class="fas fa-eye"></i> View Details
                            </span>
                            <span style="background-color: var(--info-100); color: var(--info-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                <i class="fas fa-filter"></i> Multiple Views
                            </span>
                            <span style="background-color: var(--warning-100); color: var(--warning-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                <i class="fas fa-download"></i> Export
                            </span>
                        </div>
                    </div>

                    <!-- Arrow -->
                    <div style="flex-shrink: 0; align-self: center;">
                        <i class="fas fa-chevron-right" style="font-size: var(--text-2xl); color: var(--text-tertiary);"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manual Edit Card -->
        <a href="{{ url_for('manual_timetable_edit') }}" style="text-decoration: none;">
            <div class="card card-elevated card-interactive">
                <div class="card-body" style="padding: var(--space-8);">
                    <div style="display: flex; align-items: start; gap: var(--space-6);">
                        <!-- Icon -->
                        <div style="flex-shrink: 0;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--warning-500) 0%, var(--warning-600) 100%); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-lg);">
                                <i class="fas fa-edit" style="font-size: var(--text-4xl); color: white;"></i>
                            </div>
                        </div>

                        <!-- Content -->
                        <div style="flex: 1;">
                            <h2 style="margin-bottom: var(--space-3); font-size: var(--text-2xl); color: var(--text-primary);">
                                Manual Timetable Edit
                            </h2>
                            <p class="text-secondary" style="margin-bottom: var(--space-4); line-height: 1.6;">
                                Create or modify timetable entries manually. Schedule individual classes with full control over timing, room assignment, and faculty allocation.
                            </p>
                            <div style="display: flex; gap: var(--space-3); flex-wrap: wrap;">
                                <span style="background-color: var(--warning-100); color: var(--warning-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                    <i class="fas fa-hand-pointer"></i> Full Control
                                </span>
                                <span style="background-color: var(--primary-100); color: var(--primary-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                    <i class="fas fa-cog"></i> Customizable
                                </span>
                                <span style="background-color: var(--success-100); color: var(--success-700); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--text-sm); font-weight: var(--weight-medium);">
                                    <i class="fas fa-save"></i> Easy Updates
                                </span>
                            </div>
                        </div>

                        <!-- Arrow -->
                        <div style="flex-shrink: 0; align-self: center;">
                            <i class="fas fa-chevron-right" style="font-size: var(--text-2xl); color: var(--text-tertiary);"></i>
                        </div>
                    </div>
                </div>
            </div>
        </a>

    </div>
</div>

<style>
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .card-body > div {
            flex-direction: column !important;
        }

        .card-body > div > div:last-child {
            display: none; /* Hide arrow on mobile */
        }

        .card-body > div > div:first-child {
            width: 60px !important;
            height: 60px !important;
        }

        .card-body > div > div:first-child i {
            font-size: var(--text-3xl) !important;
        }
    }
</style>

<script>
    // Handle autogenerate button click
    document.getElementById('autogenerateTimetableBtn').addEventListener('click', function() {
        // Add loading state
        const card = this;
        const originalContent = card.innerHTML;

        card.style.opacity = '0.7';
        card.style.pointerEvents = 'none';

        // Show confirmation dialog
        const confirmed = confirm('This will generate a new timetable based on all courses, faculty, and rooms in the system.\n\nAny existing timetable data will be replaced.\n\nDo you want to continue?');

        if (!confirmed) {
            card.style.opacity = '1';
            card.style.pointerEvents = 'auto';
            return;
        }

        // Show loading overlay
        const loadingDiv = document.createElement('div');
        loadingDiv.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); z-index: 9999; display: flex; align-items: center; justify-content: center;';
        loadingDiv.innerHTML = `
            <div style="background: var(--bg-elevated); padding: var(--space-8); border-radius: var(--radius-xl); box-shadow: var(--shadow-2xl); text-align: center; max-width: 400px;">
                <div class="spinner" style="width: 60px; height: 60px; border: 4px solid var(--border-primary); border-top-color: var(--primary-500); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto var(--space-6);"></div>
                <h3 style="color: var(--text-primary); margin-bottom: var(--space-3);">Generating Timetable...</h3>
                <p class="text-secondary">This may take a few moments. Please wait.</p>
            </div>
        `;
        document.body.appendChild(loadingDiv);

        // Note: Add your actual API call here
        // For now, this is a placeholder
        setTimeout(() => {
            alert('Timetable generation feature will be implemented here.\n\nThis button will trigger the auto-generation algorithm.');
            document.body.removeChild(loadingDiv);
            card.style.opacity = '1';
            card.style.pointerEvents = 'auto';
        }, 2000);
    });

    // Handle view timetable card click - Coming Soon
    document.getElementById('viewTimetableCard').addEventListener('click', function() {
        showComingSoonModal();
    });

    function showComingSoonModal() {
        const modal = document.createElement('div');
        modal.id = 'comingSoonModal';
        modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); z-index: 9999; display: flex; align-items: center; justify-content: center; animation: fadeIn 0.2s ease-out;';

        modal.innerHTML = `
            <div style="background: var(--bg-elevated); border-radius: var(--radius-2xl); box-shadow: var(--shadow-2xl); max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; animation: slideUp 0.3s ease-out;">
                <!-- Header -->
                <div style="background: linear-gradient(135deg, var(--info-500) 0%, var(--info-600) 100%); padding: var(--space-8); border-radius: var(--radius-2xl) var(--radius-2xl) 0 0; position: relative;">
                    <button onclick="closeComingSoonModal()" style="position: absolute; right: var(--space-6); top: var(--space-6); background: rgba(255, 255, 255, 0.2); border: none; color: white; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background var(--transition-fast);" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'">
                        <i class="fas fa-times" style="font-size: var(--text-lg);"></i>
                    </button>
                    <div style="text-align: center;">
                        <div style="width: 80px; height: 80px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-4);">
                            <i class="fas fa-clock" style="font-size: var(--text-4xl); color: white;"></i>
                        </div>
                        <h2 style="color: white; margin: 0; font-size: var(--text-2xl);">Coming Soon</h2>
                    </div>
                </div>

                <!-- Body -->
                <div style="padding: var(--space-8);">
                    <div style="text-align: center; margin-bottom: var(--space-6);">
                        <p style="color: var(--text-primary); font-size: var(--text-lg); line-height: 1.6;">
                            The <strong>View Created Timetable</strong> feature is currently under development and will be available soon.
                        </p>
                    </div>

                    <!-- Note Section -->
                    <div style="background: var(--bg-secondary); border: 1px solid var(--border-primary); border-radius: var(--radius-lg); padding: var(--space-6); margin-bottom: var(--space-6);">
                        <div style="display: flex; gap: var(--space-3); align-items: start; margin-bottom: var(--space-4);">
                            <i class="fas fa-sticky-note" style="color: var(--warning-600); font-size: var(--text-xl); margin-top: 2px;"></i>
                            <h3 style="color: var(--text-primary); margin: 0; font-size: var(--text-lg);">Development Note</h3>
                        </div>
                        <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: var(--space-4);">
                            This feature will allow you to:
                        </p>
                        <ul style="color: var(--text-secondary); line-height: 1.8; margin: 0; padding-left: var(--space-6);">
                            <li>View generated timetables in multiple formats</li>
                            <li>Filter by course, room, or faculty</li>
                            <li>Export schedules to PDF or Excel</li>
                            <li>Print-friendly layout options</li>
                            <li>Search and quick navigation</li>
                        </ul>
                    </div>

                    <!-- Planned Features -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--space-3); margin-bottom: var(--space-6);">
                        <div style="text-align: center; padding: var(--space-4); background: var(--success-50); border-radius: var(--radius-lg); border: 1px solid var(--success-200);">
                            <i class="fas fa-filter" style="color: var(--success-600); font-size: var(--text-2xl); margin-bottom: var(--space-2);"></i>
                            <p style="color: var(--success-700); font-size: var(--text-sm); font-weight: var(--weight-semibold); margin: 0;">Advanced Filters</p>
                        </div>
                        <div style="text-align: center; padding: var(--space-4); background: var(--info-50); border-radius: var(--radius-lg); border: 1px solid var(--info-200);">
                            <i class="fas fa-download" style="color: var(--info-600); font-size: var(--text-2xl); margin-bottom: var(--space-2);"></i>
                            <p style="color: var(--info-700); font-size: var(--text-sm); font-weight: var(--weight-semibold); margin: 0;">Export Options</p>
                        </div>
                        <div style="text-align: center; padding: var(--space-4); background: var(--warning-50); border-radius: var(--radius-lg); border: 1px solid var(--warning-200);">
                            <i class="fas fa-print" style="color: var(--warning-600); font-size: var(--text-2xl); margin-bottom: var(--space-2);"></i>
                            <p style="color: var(--warning-700); font-size: var(--text-sm); font-weight: var(--weight-semibold); margin: 0;">Print Layouts</p>
                        </div>
                    </div>

                    <!-- Footer Message -->
                    <div style="text-align: center; padding: var(--space-4); background: linear-gradient(135deg, var(--primary-50) 0%, var(--secondary-50) 100%); border-radius: var(--radius-lg); border: 1px solid var(--primary-200);">
                        <p style="color: var(--primary-700); margin: 0; font-size: var(--text-sm);">
                            <i class="fas fa-info-circle"></i>
                            <strong>Stay tuned!</strong> We're working hard to bring you this feature.
                        </p>
                    </div>

                    <!-- Close Button -->
                    <button onclick="closeComingSoonModal()" class="btn btn-primary btn-lg" style="width: 100%; margin-top: var(--space-6);">
                        <i class="fas fa-check"></i>
                        <span>Got it, thanks!</span>
                    </button>
                </div>
            </div>
        `;

        document.body.appendChild(modal);
        document.body.style.overflow = 'hidden';

        // Close on background click
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeComingSoonModal();
            }
        });

        // Close on Escape key
        document.addEventListener('keydown', handleEscapeKey);
    }

    function closeComingSoonModal() {
        const modal = document.getElementById('comingSoonModal');
        if (modal) {
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.remove();
                document.body.style.overflow = 'auto';
            }, 200);
        }
        document.removeEventListener('keydown', handleEscapeKey);
    }

    function handleEscapeKey(e) {
        if (e.key === 'Escape') {
            closeComingSoonModal();
        }
    }
</script>

<style>
    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    @keyframes slideUp {
        from {
            transform: translateY(30px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }
</style>
{% endblock %}
